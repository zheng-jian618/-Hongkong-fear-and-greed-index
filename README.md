# -Hongkong-fear-and-greed-index
本指数是一个量化市场情绪的合成指标，旨在捕捉投资者在港股市场中的集体心理状态——即当前市场是处于“过度恐惧”（悲观、抛售）还是“过度贪婪”（乐观、追高）阶段。取值范围为 0～100：  0～20：极度恐惧（Extreme Fear）—— 市场悲观，可能存在错杀机会 20～40：恐惧（Fear） 40～60：中性（Neutral） 60～80：贪婪（Greed） 80～100：极度贪婪（Extreme Greed）—— 市场亢奋，警惕回调风险 该指数借鉴自 CNN 的“恐惧与贪婪指数”理念，并针对港股市场特性进行本地化重构，融合了波动率、资金流、估值溢价与价格趋势四大维度，旨在为投资者提供一个客观、可量化的市场情绪“温度计”。

---
## 🎯 指数含义
| 指数值 | 情绪状态   | 投资含义                     |
|--------|------------|------------------------------|
| 0–20   | 极度恐惧   | 市场过度悲观，可能存在错杀机会 |
| 20–40  | 恐惧       | 谨慎观望，不宜追跌           |
| 40–60  | 中性       | 市场均衡，按策略执行         |
| 60–80  | 贪婪       | 谨慎乐观，避免追高           |
| 80–100 | 极度贪婪   | 市场过热，警惕回调风险       |
> ⚠️ **注意**：本指数为**情绪指标**，不构成买卖建议，需结合基本面与技术面综合判断。
>---
>
>  ## 🔧 指数构造原理与合理性

本指数采用多因子加权合成法，融合四大维度，每项均基于行为金融理论与港股市场特性设计。各子指标说明如下：

### 1. 恒生波幅指数（VHSI）得分（权重：30%）

- **数据来源**：本地文件 `vhsi_daily.csv`
- **逻辑**：VHSI 是港交所发布的恒生指数未来30日隐含波动率。**数值越高，代表市场恐慌情绪越强**。
- **合理性**：
  - 波动率是衡量市场恐惧的经典代理变量（如美股 VIX 指数）；
  - 港股缺乏活跃的个股期权市场，VHSI 是目前最权威、连续性最好的全市场波动率指标；
  - 采用滚动252个交易日（约1年）的历史分位数动态划分高低区间，避免固定阈值在不同宏观周期下的失效。
- **打分规则（反向映射）**：
  - VHSI ≥ 滚动252日 80% 分位 → 0 分（极度恐惧）
  - VHSI ≥ 滚动252日 50% 分位 → 25 分（恐惧）
  - VHSI ≥ 滚动252日 20% 分位 → 50 分（中性）
  - VHSI < 滚动252日 20% 分位 → 75 分（低波动 = 贪婪）
- **补充处理**：若滚动窗口内有效数据不足，以50分填充，确保指数连续。

### 2. 南向资金情绪得分（权重：30%）

- **数据来源**：本地文件 `south_money_daily.csv`（至少包含前5列：日期、当日成交净买额、买入成交额、卖出成交额、历史累计净买额）
- **逻辑**：南向资金反映内地投资者对港股的信心。**持续净流入代表乐观（贪婪），持续净流出代表悲观（恐惧）**。
- **合理性**：
  - 自沪港通/深港通开通以来，南向资金已成为影响港股流动性和估值的关键边际力量；
  - 仅使用"当日成交净买额"作为核心输入，避免冗余；
  - 通过滚动252日 Z-Score 标准化，消除绝对金额随时间增长带来的尺度漂移；
  - 引入"连续流入/流出天数（Streak）"机制，捕捉资金流的动量效应。
- **打分规则**：
  - 基础分 = `(Z-Score + 3) / 6 * 50` → 映射至 [0, 50]
  - 动量奖励 = `min(|连续天数| × 0.5, 25)`
  - 最终得分 = 基础分 + 动量奖励（若连续流入）或 - 动量奖励（若连续流出）
  - 得分裁剪至 [0, 100]
- **补充处理**：Z-Score 在标准差为0时设为0；初始 Streak 从0开始累积。

### 3. AH 溢价指数百分位（权重：25%）

- **数据来源**：本地文件 `ah_premium_daily.csv`
- **逻辑**：AH 溢价指数 = A 股价格加权平均 / H 股价格加权平均（可比公司）。**溢价越高，H 股相对越便宜，吸引力越强，情绪越贪婪**。
- **合理性**：
  - AH 溢价是港股独有的跨市场估值锚，反映 A/H 投资者风险偏好差异；
  - 高溢价常伴随港股估值洼地和内资配置需求上升（如2022年底）；
  - 使用滚动1000日历史百分位衡量当前位置，兼顾稳定性与适应性。
- **打分规则**：
  - AH 百分位 = `当前值在滚动窗口中的排名 / 窗口长度 × 100`
  - 得分 = 百分位值（即 0～100）
- **补充处理**：若窗口不足252日，改用 expanding（扩张窗口）计算，确保早期有值。

### 4. 恒生指数（HSI）趋势得分（权重：15%）

- **数据来源**：本地文件 `hsi_daily.csv`
- **逻辑**：价格趋势会强化或缓解情绪。**上涨趋势中的"贪婪"更可持续，下跌趋势中的"恐惧"可能尚未见底**。
- **合理性**：
  - 单纯依赖情绪易导致"抄在半山腰"或"逃在启动前"；
  - 引入趋势确认可提升信号稳健性，符合"顺势而为 + 逆情绪操作"的复合策略思想；
  - 20日窗口兼顾短期动量与噪声过滤。
- **打分规则**：
  - 动量分 = `HSI 20日涨跌幅的滚动百分位排名 × 50`
  - 均线分 = `50 if HSI > 20日均线 else 0`
  - 趋势得分 = `(动量分 + 均线分) / 2`
- **补充处理**：动量分在数据不足时以25分填充（中性假设）。

### 合成公式

最终恐贪指数按以下加权公式合成：
```
FearGreed = 0.30 * VHSI_Score + 0.30 * South_Score + 0.25 * AH_Score + 0.15 * Trend_Score
```

## 📦 所需 Python 库

本项目仅依赖以下开源库：

| 库名         | 用途                             |
|--------------|----------------------------------|
| `pandas`     | 数据加载、清洗、时间序列处理     |
| `numpy`      | 数值计算                         |
| `matplotlib` | 绘制图表（可选）                 |
| `akshare`    | 金融数据端口                     |

安装命令：
```bash
pip install pandas numpy matplotlib akshare
```

